{% extends "_layout.html" %}
{% block content %}
<div class="col-lg-6">
    <form method="POST" action="{{ url_for('nmap') }}">
        <fieldset>
            <ledend>nmap scan</ledend>              
            <div class="form-group">
                <label class="col-form-label col-form-label-lg" for="inputLarge">IP Range:</label>
                <input class="form-control form-control-lg" 
                       type="text" 
                       name="ip_network" 
                       placeholder="Enter IPv4 Network" 
                       id="inputLarge"
                       value="{% if request.form %}{{ request.form.get('ip_network') }}{% endif %}">
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary">Scan Now</button>
            </div>
        </fieldset>      
    </form>
    {% if request.form %}
        {% if hosts %}
            <table class="table table-striped table-hover">
                <thead>
                    <th>Discovered {{ total_hosts }} Hosts</th>
                </thead>
                <tbody>
                    {% for host in hosts %}
                    <tr>
                        <td>{{ host }} 
                            {% if "Host is up" in host %} 
                            <span class="pull-right">
                                <i class="fa fa-check-circle text-success"></i>
                            </span>
                            {% endif %}
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        {% else %}
            <div class="alert alert-info alert-dismissible" style="margin-top:10px;">
                <button type="button" class="close" data-dismiss="alert">&times;</button>
                <p> 
                    <i class="fa fa-warning"></i>No hosts found for network: {{ ip_network }}
                </p>
            </div>
        {% endif %}
    {% endif %}
</div>
{% endblock %}